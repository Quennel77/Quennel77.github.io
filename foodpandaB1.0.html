<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>å ±é…¬è¨ˆç®—</title>
<style>
/* === ä½ çš„åŸæ¨£å¼ï¼ˆæœªå‹•ï¼‰ === */
body{
  font-family: Arial, sans-serif;
  margin: 6;                     /* ä½ è¦çš„ä¿®æ”¹ */
  padding-top: env(safe-area-inset-top, 0px);  /* å¯é¸ï¼šé¿å…è¢«ç€æµ·é®ä½ */
  background: #121212;
  color: #eee;
}
.container{width:90%;max-width:500px;margin:auto;background:#1e1e1e;padding:0px;border-radius:22px;box-shadow:0 4px 10px rgba(0,0,0,0.5);box-sizing:border-box;}
h2{display:flex;justify-content:space-between;align-items:center;color:#eee;}
label{display:block;margin-top:10px;font-weight:bold;color:#eee;}
.input-group{display:flex;margin:2px 0;}
input{width:calc(100% - 50px);padding:10px;font-size:16px;background:#2a2a2a;color:#eee;border:1px solid #555;border-radius:6px;}
.inc-btn,.dec-btn,.reset-btn{width:60px;height:60px;font-size:26px;margin-left:5px;border:none;border-radius:8px;background:#ff69b4;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:transform .2s,background .2s;}
.inc-btn:hover,.dec-btn:hover,.reset-btn:hover{background:#005fa3;transform:rotate(20deg);}
.result{margin-top:15px;font-size:28px;text-align:center;font-weight:bold;}
#amount{width:200px;font-size:30px;padding:2px 4px;text-align:center;background:#2a2a2a;border:1px solid #555;color:#fc1212;}
#formula{margin-top:15px;font-size:16px;color:#eee;line-height:1.5;white-space:pre-line;text-align:center;}
#oldFormula,#secondHint{margin-top:2px;font-size:15px;color:#ccc;line-height:1.4;white-space:normal;text-align:center;}
#errorMsg{color:red;margin-bottom:10px;font-weight:bold;}
.sub-result{font-size:16px!important;}
.sub-result #secondAmount{width:80px!important;font-size:18px!important;padding:2px 4px!important;}
body,button{touch-action:manipulation;-webkit-user-select:none;-webkit-tap-highlight-color:transparent;}
input{touch-action:auto;-webkit-user-select:text;}
input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0;}
input[type=number]{-moz-appearance:textfield;}
button,.calc-btn,.reset-btn{transition:none !é‡è¦;transform:none!important;}
button:active,.calc-btn:active,.reset-btn:active{transform:none!important;scale:1!important;}
.order-block{max-width:300px;margin:20px auto;font-size:16px;font-family:Arial,sans-serif;color:#eee;}
.order-block input{background:#2a2a2a;color:#eee;border:1px solid #555;}
.order-block span{color:#ccc;}
.order-block button{background:#0078d7;color:#fff;}
#yVal,#xVal{padding:4px 6px;height:28px;font-size:20px;}
.inc-btn,.dec-btn{width:60px;height:38px;font-size:22px!important;line-height:1!important;margin-left:4px;border-radius:6px;border:none;background:#ff69b4;color:#fff;cursor:pointer;}
#base25,#extraFee,#base25secondHint,#extraFeesecondHint{font-size:15px;margin-top:4px;text-align:center;}
#base25,#base25secondHint{color:#f2c2c2;}
#extraFee,#extraFeesecondHint{color:#ccc;}
@media(max-width:375px){
  .inc-btn,.dec-btn,.reset-btn{width:38px;height:38px;font-size:20px;}
  #amount{font-size:32px;width:130px;}
  #formula,#oldFormula,#secondHint{font-size:14px;}
}

/* === é–‹å•ŸæŒ‘é¸å™¨çš„æŒ‰éˆ•ï¼ˆä¸å½±éŸ¿åŸ + / âˆ’ï¼‰ === */
.picker-btn{
  width:50px;                 /* ä¿æŒç‰ˆé¢è¨ˆç®—ä¸è®Š */
  height:38px;
  margin-left:4px;
  margin-right:0px;         /* æŠŠ 18px ç©ºé–“é‚„å›å» */
  border:1px solid #555;
  border-radius:6px;
  background:#2a2a2a;
  color:#eee;
  font-size:20px;
  cursor:pointer;
  transform:scale(0.64);      /* è¦–è¦ºç¸®å° */
  transform-origin:right center;
  padding:0;                  /* å»å…§è·ï¼Œé¿å…è¢«æ’é–‹ */
}

/* =========================
   âœ… ç©©å®šç‰ˆæŒ‘é¸å™¨ï¼ˆå…±ç”¨æ¨£å¼ï¼‰
   ========================= */
.picker-overlay{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:9999;}
.picker{width:min(92vw,420px);max-height:72vh;background:#1f1f1f;border:1px solid #444;border-radius:14px;box-shadow:0 12px 40px rgba(0,0,0,.6);display:flex;flex-direction:column;overflow:hidden;}
.picker-header{padding:12px 16px;font-size:16px;color:#eee;border-bottom:1px solid #333;text-align:center;}
.picker-wheel{position:relative;height:260px;overflow-y:auto;scrollbar-width:thin;overscroll-behavior:contain;}
.picker-list{margin:0;padding:8px 0;list-style:none;}
.picker-item{height:46px;display:flex;align-items:center;justify-content:center;font-size:20px;color:#ccc;user-select:none;cursor:pointer;}
.picker-item:hover{background:#2a2a2a;}
.picker-item.active{color:#fff;font-weight:800;background:rgba(255,255,255,.08);outline:1px solid rgba(255,255,255,.22);}
.picker-actions{display:flex;gap:10px;padding:12px;border-top:1px solid #333;}
.picker-actions button{flex:1;height:40px;border-radius:8px;border:1px solid #555;background:#2a2a2a;color:#eee;font-size:16px;cursor:pointer;}
.picker-actions .confirm{background:#0a84ff;border-color:#0a84ff;color:#fff;}
</style>
</head>

<body>
<div class="container">
  <h2>
    å ±é…¬è¨ˆç®—
    <button class="reset-btn" onclick="resetValues()">ğŸ”„</button>
  </h2>

  <label>ç•¶æ™‚å€ç‡ï¼š</label>
  <div class="input-group">
    <!-- ğŸ”§ step æ”¹ç‚º 0.01 é…åˆ 0.01 å¢é‡ -->
    <input type="number" id="yVal" value="1.40" step="0.01" oninput="calc()">
    <!-- âœ… æ–°å¢ï¼šå€ç‡æŒ‘é¸å™¨æŒ‰éˆ• -->
    <button class="picker-btn" id="openYPicker" aria-label="é¸æ“‡å€ç‡">â­¥</button>
    <button class="inc-btn">+</button>
    <button class="dec-btn">-</button>
  </div>
  
  <label>ç¸½å…¬é‡Œæ•¸ï¼š</label>
  <div class="input-group">
    <input type="number" id="xVal" value="2.50" step="0.10" oninput="calc()">
    <!-- âœ… æ—¢æœ‰çš„å…¬é‡Œæ•¸æŒ‘é¸å™¨æŒ‰éˆ• -->
    <button class="picker-btn" id="openXPicker" aria-label="é¸æ“‡å…¬é‡Œæ•¸">â­¥</button>
    <button class="inc-btn">+</button>
    <button class="dec-btn">-</button>
  </div>

  <div id="errorMsg"></div>

  <div class="result">
    <input type="number" id="amount" value="" step="0.01" placeholder="è¼¸å…¥é‡‘é¡" /> å…ƒ
    <div id="base25"></div>
    <div id="extraFee"></div>
    <div id="secondHint"></div>
    <div class="sub-result">
      <span class="second-text">ç–Šå–®ï¼š</span>
      <input type="number" id="secondAmount" value="" step="0.01" placeholder="è¼¸å…¥é‡‘é¡" 
        style="width:90px; font-size:18px; text-align:center; background:#2a2a2a; color:#fc1212; border:1px solid #555; border-radius:6px;"> å…ƒ
    </div>
    <div id="base25secondHint"></div>
    <div id="extraFeesecondHint"></div>
    <div id="oldFormula"></div>
  </div>
</div>

<!-- === X PICKERï¼šå…¬é‡Œæ•¸æŒ‘é¸å™¨ DOM === -->
<div class="picker-overlay" id="xPickerOverlay" role="dialog" aria-modal="true" aria-labelledby="xPickerTitle">
  <div class="picker">
    <div class="picker-header" id="xPickerTitle">é¸æ“‡å…¬é‡Œæ•¸ï¼š<span id="xPickerNow" style="color:#0a84ff;font-weight:700;">â€”</span></div>
    <div class="picker-wheel" id="xPickerWheel"><ul class="picker-list" id="xPickerList"></ul></div>
    <div class="picker-actions">
      <button type="button" class="cancel" id="xPickerCancel">å–æ¶ˆ</button>
      <button type="button" class="confirm" id="xPickerConfirm">ç¢ºèª</button>
    </div>
  </div>
</div>

<!-- === Y PICKERï¼šå€ç‡æŒ‘é¸å™¨ DOMï¼ˆæ–°åŠ ï¼‰ === -->
<div class="picker-overlay" id="yPickerOverlay" role="dialog" aria-modal="true" aria-labelledby="yPickerTitle">
  <div class="picker">
    <div class="picker-header" id="yPickerTitle">é¸æ“‡å€ç‡ï¼š<span id="yPickerNow" style="color:#0a84ff;font-weight:700;">â€”</span></div>
    <div class="picker-wheel" id="yPickerWheel"><ul class="picker-list" id="yPickerList"></ul></div>
    <div class="picker-actions">
      <button type="button" class="cancel" id="yPickerCancel">å–æ¶ˆ</button>
      <button type="button" class="confirm" id="yPickerConfirm">ç¢ºèª</button>
    </div>
  </div>
</div>

<script>
/* ===== ä½ çš„åŸå§‹é‚è¼¯ï¼ˆæœªå‹•ï¼‰ ===== */
const DEFAULT_X=2.50, DEFAULT_Y=1.40, SECOND_FLOOR=30; let KM_FEE=11.50;//12.142 12.01 11.50
function change(id,delta){const input=document.getElementById(id);let value=parseFloat(input.value)||0;if(id==="xVal"){value+=delta;if(value<2.50)value=2.50;}else{value+=delta;if(value<0)value=0;}input.value=value.toFixed(2);calc();}
function showError(msg){document.getElementById('errorMsg').innerText=msg||'';}
function calc(){
  const x=parseFloat(document.getElementById('xVal').value);
  const y=parseFloat(document.getElementById('yVal').value);
  const amountInput=document.getElementById('amount');
  if(isNaN(x)||isNaN(y)){showError('');return;} else {showError('');}
  const baseFirst=(10+10+5+5)*y;
  const distancePart=Math.max(0,(x-2.50))*KM_FEE*y;
  const first=baseFirst+distancePart;
  const baseSecondRaw=(10+5+5)*y;
  const baseSecond25=Math.max(SECOND_FLOOR,baseSecondRaw);
  const distanceSecondFee=distancePart;
  const second=baseSecond25+distanceSecondFee;
  if(!(document.activeElement&&document.activeElement.id==='amount')) amountInput.value=first.toFixed(2);
  const base25=(10+10+5+5)*y, distanceFee=distancePart;
  document.getElementById('base25').innerText=`ç›®å‰å–®åƒ¹ï¼š ${base25.toFixed(2)} å…ƒ`;
  document.getElementById('extraFee').innerText=`å¤šå‡ºé‡Œç¨‹è²»ç”¨ï¼š ${distanceFee.toFixed(2)} å…ƒ`;
  const secondInput=document.getElementById('secondAmount');
  const activeId=document.activeElement?document.activeElement.id:"";
  if(activeId!=='secondAmount') secondInput.value=second.toFixed(2);
  document.getElementById('base25secondHint').innerText=`ç›®å‰ç–Šå–®å–®åƒ¹ï¼š ${baseSecond25.toFixed(2)} å…ƒ`;
  document.getElementById('extraFeesecondHint').innerText=`å¤šå‡ºç–Šå–®é‡Œç¨‹è²»ç”¨ï¼š ${distanceSecondFee.toFixed(2)} å…ƒ`;
  const oldResultRush=(40+((x-2.5)*15)+2).toFixed(2);
  const diffRush=(first-oldResultRush).toFixed(2);
  document.getElementById('oldFormula').innerHTML=`èˆŠåˆ¶ç®—æ³•ï¼šé¤æœŸ 40+2 + ${(x-2.5).toFixed(2)}Ã—15 = <span style="color:#fa6969; font-weight:bold;">${oldResultRush} å…ƒ</span><br>(å·® ${diffRush} å…ƒ)`;
}
document.getElementById('amount').addEventListener('input',function(){
  const price=parseFloat(this.value), y=parseFloat(document.getElementById('yVal').value), xInput=document.getElementById('xVal');
  if(this.value===''){showError('');return;}
  if(isNaN(price)||isNaN(y)||y===0){showError('');return;}
  const fixedPart=(10+10+5+5)*y;
  const x=((price-fixedPart)/(KM_FEE*y))+2.5;
  if(!isFinite(x)||x<2.50) return;
  xInput.value=x.toFixed(2); calc();
});
document.getElementById('secondAmount').addEventListener('input',function(){
  const price=parseFloat(this.value), y=parseFloat(document.getElementById('yVal').value), xInput=document.getElementById('xVal');
  const base=Math.max(30,(10+5+5)*y);
  if(this.value===''||isNaN(price)||isNaN(y)||y===0) return;
  const x=((price-base)/(KM_FEE*y))+2.5;
  if(!isFinite(x)||x<2.5) return;
  xInput.value=x.toFixed(2); calc();
});
function resetValues(){document.getElementById('xVal').value=DEFAULT_X.toFixed(2);document.getElementById('yVal').value=DEFAULT_Y.toFixed(2);calc();}
document.querySelectorAll('.inc-btn,.dec-btn').forEach(btn=>{
  let timer=null,interval=null;const shortStep=.1,longStep=.01,delay=400,speed=400;
  const getTargetId=b=>b.closest('.input-group').querySelector('input').id;
  const doStep=(b,step)=>{const id=getTargetId(b);const delta=b.classList.contains('inc-btn')?step:-step;change(id,delta);};
  const start=e=>{if(e.type==='mousedown'&&'ontouchstart'in window)return;e.preventDefault();timer=setTimeout(()=>{interval=setInterval(()=>doStep(btn,longStep),speed);},delay);};
  const stop=e=>{clearTimeout(timer);clearInterval(interval);if(e.type!=='mouseleave'&&!interval){doStep(btn,shortStep);}timer=interval=null;};
  btn.addEventListener('touchstart',start);btn.addEventListener('touchend',stop);btn.addEventListener('touchcancel',stop);
  btn.addEventListener('mousedown',start);btn.addEventListener('mouseup',stop);btn.addEventListener('mouseleave',stop);
});

/* ===== å…±ç”¨ï¼šé–èƒŒæ™¯å·å‹•ï¼ˆè¡Œå‹•è£ç½®ç©©å®šï¼‰ ===== */
let bodyScrollY=0;
function lockBodyScroll(){ bodyScrollY=window.scrollY||document.documentElement.scrollTop||0; document.body.style.position='fixed'; document.body.style.top=`-${bodyScrollY}px`; document.body.style.left='0'; document.body.style.right='0'; document.body.style.width='100%'; }
function unlockBodyScroll(){ document.body.style.position=''; document.body.style.top=''; document.body.style.left=''; document.body.style.right=''; document.body.style.width=''; window.scrollTo(0, bodyScrollY); }

/* ===== X PICKERï¼šå…¬é‡Œæ•¸ï¼ˆæ—¢æœ‰ï¼‰ ===== */
const MIN_X=2.50, MAX_X=15.00, STEP_X=0.01;
const xPicker={ overlay:document.getElementById('xPickerOverlay'), wheel:document.getElementById('xPickerWheel'), list:document.getElementById('xPickerList'), btnOpen:document.getElementById('openXPicker'), btnCancel:document.getElementById('xPickerCancel'), btnConfirm:document.getElementById('xPickerConfirm'), now:document.getElementById('xPickerNow'), value:DEFAULT_X };

function buildXList(){
  if(xPicker.list.childElementCount>0) return;
  const frag=document.createDocumentFragment();
  for(let v=MIN_X; v<=MAX_X+1e-9; v+=STEP_X){
    const li=document.createElement('li');
    li.className='picker-item'; li.dataset.value=v.toFixed(2); li.textContent=v.toFixed(2)+' km';
    li.addEventListener('click', ()=>{ setActiveX(parseFloat(li.dataset.value)); li.scrollIntoView({block:'center',behavior:'smooth'}); });
    frag.appendChild(li);
  }
  xPicker.list.appendChild(frag);
}
function setActiveX(val){
  const v=Math.min(MAX_X,Math.max(MIN_X,val));
  xPicker.value=parseFloat(v.toFixed(2));
  xPicker.now.textContent=xPicker.value.toFixed(2)+' km';
  xPicker.list.querySelectorAll('.picker-item.active').forEach(el=>el.classList.remove('active'));
  const target=xPicker.list.querySelector(`.picker-item[data-value="${xPicker.value.toFixed(2)}"]`);
  if(target) target.classList.add('active');
}
function openXPicker(){
  buildXList();
  // è®€ç›®å‰è¼¸å…¥æ¡†å€¼ï¼ˆè‹¥ NaN å‰‡ç”¨ä¸‹é™ï¼‰
  const curr = parseFloat(document.getElementById('xVal').value);
  setActiveX(isNaN(curr) ? MIN_X : curr);

  xPicker.overlay.style.display = 'flex';
  lockBodyScroll();
  document.addEventListener('keydown', keyNavX);

  // âœ… é–‹å•Ÿæ™‚ç«‹å³æŠŠç›®å‰å€¼ç½®ä¸­ï¼ˆç„¡å‹•ç•« â†’ ä¸æœƒåƒè‡ªå·±æ»‘å‹•ï¼‰
  const target = xPicker.list.querySelector(`.picker-item[data-value="${xPicker.value.toFixed(2)}"]`);
  if (target) target.scrollIntoView({ block: 'center', behavior: 'auto' });
}
function closeXPicker(){ xPicker.overlay.style.display='none'; document.removeEventListener('keydown', keyNavX); unlockBodyScroll(); }
function keyNavX(e){
  if(xPicker.overlay.style.display!=='flex') return;
  if(e.key==='ArrowUp'||e.key==='ArrowDown'){ e.preventDefault(); setActiveX(xPicker.value+(e.key==='ArrowUp'?-STEP_X:STEP_X)); const t=xPicker.list.querySelector(`.picker-item[data-value="${xPicker.value.toFixed(2)}"]`); if(t) t.scrollIntoView({block:'center',behavior:'auto'}); }
  else if(e.key==='Enter'){ confirmXPicker(); } else if(e.key==='Escape'){ closeXPicker(); }
}
function confirmXPicker(){ const input=document.getElementById('xVal'); input.value=xPicker.value.toFixed(2); closeXPicker(); calc(); }
xPicker.btnOpen.addEventListener('click', openXPicker);
xPicker.btnCancel.addEventListener('click', closeXPicker);
xPicker.btnConfirm.addEventListener('click', confirmXPicker);
xPicker.overlay.addEventListener('click', e=>{ if(e.target===xPicker.overlay) closeXPicker(); });

/* ===== Y PICKERï¼šå€ç‡ï¼ˆâ˜…æ­¤è™•æŒ‰ä½ çš„éœ€æ±‚èª¿æ•´ç¯„åœèˆ‡æ­¥é€²ï¼‰ ===== */
const MIN_Y=1.35, MAX_Y=6.99, STEP_Y=0.01;  // â† 1.35~6.99ï¼Œ0.01éå¢
const yPicker={ overlay:document.getElementById('yPickerOverlay'), wheel:document.getElementById('yPickerWheel'), list:document.getElementById('yPickerList'), btnOpen:document.getElementById('openYPicker'), btnCancel:document.getElementById('yPickerCancel'), btnConfirm:document.getElementById('yPickerConfirm'), now:document.getElementById('yPickerNow'), value:DEFAULT_Y };

function buildYList(){
  if(yPicker.list.childElementCount>0) return;
  const frag=document.createDocumentFragment();
  for(let v=MIN_Y; v<=MAX_Y+1e-9; v+=STEP_Y){
    const fixed = v.toFixed(2);
    const li=document.createElement('li');
    li.className='picker-item'; li.dataset.value=fixed; li.textContent=fixed+' Ã—';
    li.addEventListener('click', ()=>{ setActiveY(parseFloat(li.dataset.value)); li.scrollIntoView({block:'center',behavior:'smooth'}); });
    frag.appendChild(li);
  }
  yPicker.list.appendChild(frag);
}
function setActiveY(val){
  const v=Math.min(MAX_Y,Math.max(MIN_Y,val));
  yPicker.value=parseFloat(v.toFixed(2));
  yPicker.now.textContent=yPicker.value.toFixed(2)+' Ã—';
  yPicker.list.querySelectorAll('.picker-item.active').forEach(el=>el.classList.remove('active'));
  const target=yPicker.list.querySelector(`.picker-item[data-value="${yPicker.value.toFixed(2)}"]`);
  if(target) target.classList.add('active');
}
function openYPicker(){
  buildYList();
  // è®€ç›®å‰è¼¸å…¥æ¡†å€¼ï¼ˆè‹¥ NaN å‰‡ç”¨é è¨­ 1.40ï¼‰ï¼ŒsetActiveY å…§æœƒè‡ªå‹•å¤¾åœ¨ 1.35~6.99 ç¯„åœ
  const curr = parseFloat(document.getElementById('yVal').value);
  setActiveY(isNaN(curr) ? DEFAULT_Y : curr);

  yPicker.overlay.style.display = 'flex';
  lockBodyScroll();
  document.addEventListener('keydown', keyNavY);

  // âœ… é–‹å•Ÿæ™‚ç«‹å³æŠŠç›®å‰å€¼ç½®ä¸­ï¼ˆç„¡å‹•ç•«ï¼‰
  const target = yPicker.list.querySelector(`.picker-item[data-value="${yPicker.value.toFixed(2)}"]`);
  if (target) target.scrollIntoView({ block: 'center', behavior: 'auto' });
}
function closeYPicker(){ yPicker.overlay.style.display='none'; document.removeEventListener('keydown', keyNavY); unlockBodyScroll(); }
function keyNavY(e){
  if(yPicker.overlay.style.display!=='flex') return;
  if(e.key==='ArrowUp'||e.key==='ArrowDown'){ e.preventDefault(); setActiveY(yPicker.value+(e.key==='ArrowUp'?-STEP_Y:STEP_Y)); const t=yPicker.list.querySelector(`.picker-item[data-value="${yPicker.value.toFixed(2)}"]`); if(t) t.scrollIntoView({block:'center',behavior:'auto'}); }
  else if(e.key==='Enter'){ confirmYPicker(); } else if(e.key==='Escape'){ closeYPicker(); }
}
function confirmYPicker(){ const input=document.getElementById('yVal'); input.value=yPicker.value.toFixed(2); closeYPicker(); calc(); }
yPicker.btnOpen.addEventListener('click', openYPicker);
yPicker.btnCancel.addEventListener('click', closeYPicker);
yPicker.btnConfirm.addEventListener('click', confirmYPicker);
yPicker.overlay.addEventListener('click', e=>{ if(e.target===yPicker.overlay) closeYPicker(); });

/* åˆå§‹ */
window.onload=function(){ resetValues(); };
</script>

<!-- === ä½ çš„å–å–®ç‡å€å¡Šï¼ˆæœªå‹•ï¼‰ === -->
<div class="order-block" style="background:#1e1e1e; padding:10px; border-radius:12px;">
  <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #555; padding:8px 0;">
    <label for="completed" style="font-size:14px; color:#eee;">éå¾€è¨˜éŒ„å®Œæˆè¨‚å–®ä»¶æ•¸</label>
    <input type="number" id="completed" value=""
           style="width:60px; text-align:right; font-size:14px; background:#2a2a2a; color:#eee; border:1px solid #555; border-radius:6px; padding:4px 6px;">
  </div>
  <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #555; padding:8px 0;">
    <label for="takeRate" style="font-size:14px; color:#eee;">å€é–“å–å–®ç‡</label>
    <div style="display:flex; align-items:center; gap:3px;">
      <input type="number" id="takeRate" value=""
             style="width:70px; text-align:right; font-size:14px; background:#2a2a2a; color:#eee; border:1px solid #555; border-radius:6px; padding:4px 6px;">
      <span style="color:#ccc; font-size:14px;">%</span>
    </div>
  </div>
  <div id="generatedOrdersResult" style="margin-top:10px; font-size:15px; font-weight:bold; text-align:center; color:#eee;"></div>
  <div id="extraInfo" style="margin-top:5px; font-size:15px; font-weight:bold; text-align:center; color:#eee;"></div>
  <div style="text-align:center; margin-top:10px;">
    <button onclick="resetOrders()" style="background:#2a2a2a; color:#eee; border:1px solid #555; padding:6px 16px; border-radius:8px; font-size:14px;">é‡ç½®</button>
  </div>
</div>

<script>
function calcOrders(){
  const completed=parseFloat(document.getElementById('completed').value);
  const takeRateInput=parseFloat(document.getElementById('takeRate').value);
  if(isNaN(completed)||isNaN(takeRateInput)||takeRateInput<=0){
    document.getElementById('generatedOrdersResult').innerText='';
    document.getElementById('extraInfo').innerText='';
    return;
  }
  const takeRate=takeRateInput/100, baseRate=0.85, generated=completed/takeRate;
  let extraText='';
  if(takeRate>=baseRate){
    const maxReject=(completed/baseRate)-generated;
    let color='#30f725'; if(maxReject<6) color='#ff4444'; else if(maxReject<11) color='#ffcc00';
    extraText=`é‚„å¯ä»¥æ‹’æ‰ <span style="color:${color}; font-weight:bold;">${maxReject.toFixed(2)}</span> å–®`;
  }else{
    const needComplete=(baseRate*generated-completed)/(1-baseRate);
    extraText=`é‚„éœ€å®Œæˆ <span style="color:#ff5555; font-weight:bold;">${needComplete.toFixed(2)}</span> å–®`;
  }
  document.getElementById('generatedOrdersResult').innerText=`ç³»çµ±ç”Ÿæˆè¨‚å–®æ•¸ï¼š${generated.toFixed(2)} å–®`;
  document.getElementById('extraInfo').innerHTML=extraText;
}
function resetOrders(){
  document.getElementById('completed').value="";
  document.getElementById('takeRate').value="";
  document.getElementById('generatedOrdersResult').innerText="";
  document.getElementById('extraInfo').innerText="";
}
document.getElementById('completed').addEventListener('input',calcOrders);
document.getElementById('takeRate').addEventListener('input',calcOrders);
window.addEventListener("load",function(){ resetValues(); resetOrders(); calc(); });
</script>

<div style="text-align:center; margin-top:30px; font-size:14px; color:#fc0303; line-height:1.8; border-top:1px solid #ccc; padding-top:10px;">
  âš ï¸ æ³¨æ„äº‹é …ï¸ âš ï¸ <br>
  â€» èˆŠåˆ¶å°±æœƒå·é å–®å…¬é‡Œæ•¸0.3~0.8å…¬é‡Œä¸ç­‰ï¼Œè«‹è‡ªè¡Œå†æ‰£é™¤â€»<br>
  â€» ä»¥ä¸Šåƒ…ä¾›åƒè€ƒâ€»<br>
  2025å¹´10æœˆ21æ—¥ 19:57 <br>
</div>
</body>
</html>

