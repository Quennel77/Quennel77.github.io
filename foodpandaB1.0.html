<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ç†Šè²“å¤–é€å€ç‡è¨ˆç®—</title>
<style>
/* === æ•´é«”æš—é»‘æ¨¡å¼ === */
body {
  font-family: Arial, sans-serif;
  margin: 40px;
  background: #121212;
  color: #eee;
}
/*
.container {
  max-width: 500px;
  margin: auto;
  background: #1e1e1e;
  padding: 20px;
  border-radius: 22px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.5);
}
*/
.container {
  width: 90%;       /* æ–°å¢ï¼šè‡ªå‹•ç¸®æ”¾åˆ°è¢å¹•å¯¬åº¦çš„ 90% */
  max-width: 500px;
  margin: auto;
  background: #1e1e1e;
  padding: 20px;
  border-radius: 22px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.5);
  box-sizing: border-box;  /* ä¿éšªï¼špadding ä¸æœƒè¶…å‡ºå¯¬åº¦ */
}
h2 {
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: #eee;
}
label { display: block; margin-top: 10px; font-weight: bold; color: #eee; }
.input-group { display: flex; margin: 10px 0; }
input { width: calc(100% - 50px); padding: 10px; font-size: 16px; background: #2a2a2a; color: #eee; border: 1px solid #555; border-radius: 6px; }

/* çµ±ä¸€ +ã€-ã€é‡ç½®æ¨£å¼ */
.inc-btn, .dec-btn, .reset-btn {
  width: 60px;
  height: 60px;
  font-size: 26px;
  margin-left: 5px;
  border: none;
  border-radius: 8px;
  background: #ff69b4;
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.2s, background 0.2s;
}
.inc-btn:hover, .dec-btn:hover, .reset-btn:hover {
  background: #005fa3;
  transform: rotate(20deg);
}

.result { margin-top: 15px; font-size: 28px; text-align: center; font-weight: bold; }
/*#amount { color: red; width: 180px; font-size: 22px; text-align: center; background: #2a2a2a; border: 1px solid #555; color: #ff5555; }*/
#amount { color: red; width: 200px; font-size: 28px; text-align: center; background: #2a2a2a; border: 1px solid #555; color: #fc1212; }

#formula { margin-top: 15px; font-size: 16px; color: #eee; line-height: 1.5; white-space: pre-line; text-align: center; }
#oldFormula {
  margin-top: 2px;
  font-size: 16px;
  color: #eee;
  line-height: 1.4;
  white-space: normal;
  text-align: center;
}
#errorMsg { color:red; margin-bottom:10px; font-weight:bold; }

/*body, input, button { touch-action: manipulation; -webkit-user-select: none; -webkit-tap-highlight-color: transparent; }*/

body, button {
  touch-action: manipulation;
  -webkit-user-select: none;
  -webkit-tap-highlight-color: transparent;
}

input {
  touch-action: auto;  /* è®“è¼¸å…¥æ¡†æ­£å¸¸å¯é»æ“Š */
  -webkit-user-select: text;
}

/* éš±è—æ•¸å­—è¼¸å…¥æ¡†çš„ä¸Šä¸‹ç®­é ­ */
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
input[type=number] { -moz-appearance: textfield; }

/* å–æ¶ˆæŒ‰éˆ•æŒ‰ä¸‹å‹•ç•« */
button, .calc-btn, .reset-btn { transition: none !important; transform: none !important; }
button:active, .calc-btn:active, .reset-btn:active { transform: none !important; scale: 1 !important; }

/* å–å–®ç‡å€å¡ŠèƒŒæ™¯æš—é»‘åŒ– */
.order-block { max-width:300px; margin:20px auto; font-size:16px; font-family:Arial, sans-serif; color:#eee; }
.order-block input { background:#2a2a2a; color:#eee; border:1px solid #555; }
.order-block span { color:#ccc; }
.order-block button { background:#0078d7; color:#fff; }

/* æ–°å¢ï¼šé…é€è²»å€å¡Šæ¨£å¼ */
.calc-block {
  max-width: 320px;
  margin: 25px auto;
  background: #1e1e1e;
  border: 1px solid #444;
  border-radius: 12px;
  padding: 15px;
  text-align: center;
}
.calc-block input {
  background:#2a2a2a;
  color:#eee;
  border:1px solid #555;
  border-radius:6px;
  text-align:center;
  padding:6px;
  width:90px;
  font-size:16px;
}
.calc-block button {
  background:#0078d7;
  color:#fff;
  border:none;
  border-radius:6px;
  padding:6px 16px;
  margin-top:10px;
  cursor:pointer;
}
/* æ–°å¢ï¼šé…é€è²»å€å¡Šæ¨£å¼ */

@media (max-width: 375px) { /* iPhone SE é¡ä¼¼å¯¬åº¦ */
  .inc-btn, .dec-btn, .reset-btn {
    width: 50px;
    height: 50px;
    font-size: 20px;
  }
  #amount {
    font-size: 32px;
    width: 150px;
  }
  #formula, #oldFormula {
    font-size: 14px;
  }
  .calc-block input {
    width: 70px;
    font-size: 14px;
  }
}
</style>
</head>

<body>
<div class="container">
  <h2>
    ç†Šè²“å¤–é€å€ç‡é‡Œç¨‹è¨ˆç®—
    <button class="reset-btn" onclick="resetValues()">ğŸ”„</button>
  </h2>

  <label>ç•¶æ™‚å€ç‡ï¼š</label>
  <div class="input-group">
    <input type="number" id="yVal" value="1.4" step="0.1" oninput="calc()">
    <button class="inc-btn" onclick="change('yVal', 0.1)">+</button>
    <button class="dec-btn" onclick="change('yVal', -0.1)">-</button>
  </div>
  
  <label>ç¸½å…¬é‡Œæ•¸ï¼š</label>
  <div class="input-group">
    <input type="number" id="xVal" value="2.5" step="0.1" oninput="calc()">
    <button class="inc-btn" onclick="change('xVal', 0.1)">+</button>
    <button class="dec-btn" onclick="change('xVal', -0.1)">-</button>
  </div>

  <div id="errorMsg"></div>

  <div id="formula">å…¬å¼å€é¡¯ç¤º</div>

  <div class="result">
    <!-- <input type="number" id="amount" value="" step="0.01" placeholder="è¼¸å…¥é‡‘é¡å¯åç®—" /> å…ƒ -->
    <input type="number" id="amount" value="" step="0.01" placeholder="è¼¸å…¥é‡‘é¡" /> å…ƒ
    <div id="oldFormula"></div>
  </div>
</div>

<script>
const DEFAULT_X = 2.5;
const DEFAULT_Y = 1.4;

function change(id, delta) {
  const input = document.getElementById(id);
  let value = parseFloat(input.value) || 0;
  value += delta;
  input.value = (Math.round(value * 10) / 10).toFixed(1);
  calc();
}

function showError(msg) {
  document.getElementById('errorMsg').innerText = msg || '';
}

function calc() {
  const xRaw = document.getElementById('xVal').value;
  const yRaw = document.getElementById('yVal').value;
  const x = parseFloat(xRaw);
  const y = parseFloat(yRaw);
  const amountInput = document.getElementById('amount');

  if (isNaN(x) || isNaN(y)) { showError(''); return; } else { showError(''); }

  //const result = (30 + ((x - 2.5) * 15)) * y;
  /*æ”¹æ–°ç‰ˆè¨ˆç®—*/
  //const result = (20 + ((x - 2.5) * 15)) * y + 5 + 5;
  /*æ”¹æ–°ç‰ˆè¨ˆç®—*/
  /*æ”¹æ–°ç‰ˆè¨ˆç®— å› é…é€è²»æœªçŸ¥ ç”¨ç¾æœ‰åŸºæœ¬å–®åƒ¹å»æ›ç®— ç¾åœ¨æ˜¯42*/
  const base = parseFloat(document.getElementById('baseFare').value);
  const rate = parseFloat(document.getElementById('rateFare').value);
  const delivery = (base - 10) / rate;
  const result = (delivery + ((x - 2.5) * 15)) * y + 5 + 5;
  /*æ”¹æ–°ç‰ˆè¨ˆç®— å› é…é€è²»æœªçŸ¥ ç”¨ç¾æœ‰åŸºæœ¬å–®åƒ¹å»æ›ç®— ç¾åœ¨æ˜¯42*/
  
  if (!(document.activeElement && document.activeElement.id==='amount')) {
    amountInput.value = result.toFixed(2);
  }
  updateFormula(x, y);
}

function updateFormula(x, y) {
  const base = parseFloat(document.getElementById('baseFare').value);
  const rate = parseFloat(document.getElementById('rateFare').value);
  const delivery = (base - 10) / rate; // å°å·¥å…·ç®—å‡ºçš„é…é€è²»
  
  const kmCalc = ((x - 2.5) * 15).toFixed(2);
  const oldBase = 40;
  const oldResult = (oldBase + parseFloat(kmCalc)).toFixed(2);
  const oldResultRush = (parseFloat(oldResult) + 2).toFixed(2);

  //const newAmount = (30 + ((x - 2.5) * 15)) * y;
  /*æ”¹æ–°ç‰ˆè¨ˆç®—*/
  //const newAmount = (20 + ((x - 2.5) * 15)) * y + 5 + 5;
  /*æ”¹æ–°ç‰ˆè¨ˆç®—*/
  /*æ”¹æ–°ç‰ˆè¨ˆç®— å› é…é€è²»æœªçŸ¥ ç”¨ç¾æœ‰åŸºæœ¬å–®åƒ¹å»æ›ç®— ç¾åœ¨æ˜¯42*/
  const newAmount = (delivery + ((x - 2.5) * 15)) * y + 5 + 5;
  /*æ”¹æ–°ç‰ˆè¨ˆç®— å› é…é€è²»æœªçŸ¥ ç”¨ç¾æœ‰åŸºæœ¬å–®åƒ¹å»æ›ç®— ç¾åœ¨æ˜¯42*/
  
  const diffNormal = (newAmount - oldResult).toFixed(2);
  const diffRush = (newAmount - oldResultRush).toFixed(2);

  /*const formulaText = 
`20(é…é€è²»)+5(å®‰å…¨çå‹µ)+5(å»£å‘Šè²»)
30 + (( ${x.toFixed(4)} - 2.5 ) Ã— 15 = ${kmCalc} å…ƒ) Ã— ${y.toFixed(1)}(å€ç‡)`;*/

/*æ”¹æ–°ç‰ˆè¨ˆç®—*/
  /*const formulaText = 
`20(é…é€è²») + (( ${x.toFixed(4)} - 2.5 ) Ã— 15 = ${kmCalc} å…ƒ) Ã— ${y.toFixed(1)}(å€ç‡) 
+5(å»£å‘Šè²») +5(å®‰å…¨çå‹µ)`;*/
/*æ”¹æ–°ç‰ˆè¨ˆç®—*/
/*æ”¹æ–°ç‰ˆè¨ˆç®— å› é…é€è²»æœªçŸ¥ ç”¨ç¾æœ‰åŸºæœ¬å–®åƒ¹å»æ›ç®— ç¾åœ¨æ˜¯42*/
  const formulaText = 
`${delivery.toFixed(4)}(é…é€è²») + (( ${x.toFixed(4)} - 2.5 ) Ã— 15 = ${kmCalc} å…ƒ) Ã— ${y.toFixed(1)}(å€ç‡) 
+5(å»£å‘Šè²») +5(å®‰å…¨çå‹µ)`;
/*æ”¹æ–°ç‰ˆè¨ˆç®— å› é…é€è²»æœªçŸ¥ ç”¨ç¾æœ‰åŸºæœ¬å–®åƒ¹å»æ›ç®— ç¾åœ¨æ˜¯42*/

/*
  const oldFormulaText = `
èˆŠåˆ¶ç®—æ³•ï¼š<br>
éé¤æœŸ 40 + ${kmCalc} = <span style="color:#a00; font-weight:bold;">${oldResult} å…ƒ</span> (å·® ${diffNormal} å…ƒ)<br>
é¤æœŸ +2 â†’ <span style="color:#a00; font-weight:bold;">${oldResultRush} å…ƒ</span> (å·® ${diffRush} å…ƒ)
`;
*/
  const oldFormulaText = `
èˆŠåˆ¶ç®—æ³•ï¼š<br>
é¤æœŸ 40+2 + ${kmCalc} = <span style="color:#fa6969; font-weight:bold;">${oldResultRush} å…ƒ</span><br>(å·® ${diffRush} å…ƒ)
`;

  document.getElementById('formula').innerText = formulaText;
  document.getElementById('oldFormula').innerHTML = oldFormulaText;
  
  // åŒæ­¥æ›´æ–° amount é¡¯ç¤ºæœ€æ–°çµæœ
  const amountInput = document.getElementById('amount');
  if (!(document.activeElement && document.activeElement.id==='amount')) {
    amountInput.value = newAmount.toFixed(2);
  }
}

document.getElementById('amount').addEventListener('input', function() {
  const price = parseFloat(this.value);
  const y = parseFloat(document.getElementById('yVal').value);
  const xInput = document.getElementById('xVal');

  if (this.value === '') { showError(''); return; }
  if (isNaN(price) || isNaN(y) || y===0) { showError(''); return; }

  //const x = ((price / y) - 30) / 15 + 2.5;
  /*æ”¹æ–°ç‰ˆè¨ˆç®—*/
  //const x = (((price - 5 - 5) / y) - 20) / 15 + 2.5;
  /*æ”¹æ–°ç‰ˆè¨ˆç®—*/
  /*æ”¹æ–°ç‰ˆè¨ˆç®— å› é…é€è²»æœªçŸ¥ ç”¨ç¾æœ‰åŸºæœ¬å–®åƒ¹å»æ›ç®— ç¾åœ¨æ˜¯42*/
  // å…ˆå–å¾—é…é€è²»
  const base = parseFloat(document.getElementById('baseFare').value);
  const rate = parseFloat(document.getElementById('rateFare').value);
  const delivery = (base - 10) / rate;
  const x = (((price - 5 - 5) / y) - delivery) / 15 + 2.5;
  /*æ”¹æ–°ç‰ˆè¨ˆç®— å› é…é€è²»æœªçŸ¥ ç”¨ç¾æœ‰åŸºæœ¬å–®åƒ¹å»æ›ç®— ç¾åœ¨æ˜¯42*/
  if (!isFinite(x)) return;
  if (x < 0) return;

  xInput.value = x.toFixed(4);
  updateFormula(x, y);
});

function resetValues() {
  // é‡ç½®ä¸Šæ–¹å€ç‡/å…¬é‡Œæ•¸
  document.getElementById('xVal').value = DEFAULT_X.toFixed(1);
  document.getElementById('yVal').value = DEFAULT_Y.toFixed(1);

  // é‡ç½®ä¸‹æ–¹é…é€è²»å°å·¥å…·
  document.getElementById('baseFare').value = 42;
  document.getElementById('rateFare').value = 1.4;

  // é‡æ–°è¨ˆç®—
  calcDelivery(); // æ›´æ–°é…é€è²»é¡¯ç¤º
  calc();         // æ›´æ–°ä¸Šæ–¹å…¬å¼
}

window.onload = function() { resetValues(); };
</script>

<!-- === éå¾€è¨˜éŒ„å€å¡Šï¼ˆé»‘æš—åŒ–ï¼‰ === -->
<div class="order-block" style="background:#1e1e1e; padding:10px; border-radius:12px;">
  <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #555; padding:8px 0;">
    <label for="completed" style="font-size:14px; color:#eee;">éå¾€è¨˜éŒ„å®Œæˆè¨‚å–®ä»¶æ•¸</label>
    <input type="number" id="completed" value=""
           style="width:60px; text-align:right; font-size:14px; background:#2a2a2a; color:#eee; border:1px solid #555; border-radius:6px; padding:4px 6px;">
  </div>

  <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #555; padding:8px 0;">
    <label for="takeRate" style="font-size:14px; color:#eee;">å€é–“å–å–®ç‡</label>
    <div style="display:flex; align-items:center; gap:3px;">
      <input type="number" id="takeRate" value=""
             style="width:70px; text-align:right; font-size:14px; background:#2a2a2a; color:#eee; border:1px solid #555; border-radius:6px; padding:4px 6px;">
      <span style="color:#ccc; font-size:14px;">%</span>
    </div>
  </div>

  <div id="generatedOrdersResult" style="margin-top:10px; font-size:15px; font-weight:bold; text-align:center; color:#eee;"></div>
  <div id="extraInfo" style="margin-top:5px; font-size:15px; font-weight:bold; text-align:center; color:#eee;"></div>

  <div style="text-align:center; margin-top:10px;">
    <button onclick="resetOrders()"
            style="background:#2a2a2a; color:#eee; border:1px solid #555; padding:6px 16px; border-radius:8px; font-size:14px;">
      é‡ç½®
    </button>
  </div>
</div>

<script>
function calcOrders() {
  const completed = parseFloat(document.getElementById('completed').value);
  const takeRateInput = parseFloat(document.getElementById('takeRate').value);

  if (isNaN(completed) || isNaN(takeRateInput) || takeRateInput <= 0) {
    document.getElementById('generatedOrdersResult').innerText = '';
    document.getElementById('extraInfo').innerText = '';
    return;
  }

  const takeRate = takeRateInput / 100;
  const baseRate = 0.85;
  const generated = completed / takeRate;

  let extraText = '';
  if (takeRate >= baseRate) {
    const maxReject = (completed / baseRate) - generated;
    extraText = `é‚„å¯ä»¥æ‹’æ‰ ${maxReject.toFixed(2)} å–®`;
  } else {
    const needComplete = (baseRate * generated - completed) / (1 - baseRate);
    extraText = `é‚„éœ€è¦å®Œæˆ ${needComplete.toFixed(2)} å–®`;
  }

  document.getElementById('generatedOrdersResult').innerText =
    `ç³»çµ±ç”Ÿæˆè¨‚å–®æ•¸ï¼š${generated.toFixed(2)} å–®`;
  document.getElementById('extraInfo').innerText = extraText;
}

function resetOrders() {
  document.getElementById('completed').value = "";
  document.getElementById('takeRate').value = "";
  document.getElementById('generatedOrdersResult').innerText = "";
  document.getElementById('extraInfo').innerText = "";
}

document.getElementById('completed').addEventListener('input', calcOrders);
document.getElementById('takeRate').addEventListener('input', calcOrders);

window.addEventListener("load", function() {
  resetValues();      // é‡ç½®å€ç‡èˆ‡å…¬é‡Œæ•¸
  resetOrders();      // é‡ç½®å–å–®ç‡å€
  calcDelivery();     // åˆå§‹åŒ–é…é€è²»
  calc();             // ç¢ºä¿å…¬å¼å€æœ‰æ›´æ–°
});
</script>


<!-- === ğŸ†• é…é€è²»è¨ˆç®—å°å·¥å…· === -->
<div class="calc-block">
  <!-- <h3 style="color:#ff69b4; margin-bottom:10px;">é…é€è²»è¨ˆç®—å°å·¥å…·</h3> -->
  <div>
    å¸¸æ…‹åŸºæœ¬å–®åƒ¹ï¼š
    <input type="number" id="baseFare" value="42" step="0.1">
  </div>
  <div style="margin-top:8px;">
    å¸¸æ…‹å€ç‡ï¼š
    <input type="number" id="rateFare" value="1.4" step="0.1">
  </div>
  <button id="resetBtn">é‡ç½®</button>
  <div id="deliveryResult" style="margin-top:8px; font-size:18px; color:#ffa500;"></div>
</div>

<script>
function calcDelivery() {
  const base = parseFloat(document.getElementById('baseFare').value);
  const rate = parseFloat(document.getElementById('rateFare').value);
  if (isNaN(base) || isNaN(rate) || rate <= 0) {
    document.getElementById('deliveryResult').innerText = 'è«‹è¼¸å…¥æœ‰æ•ˆæ•¸å€¼';
    return;
  }
  const delivery = (base - 10) / rate;
  document.getElementById('deliveryResult').innerText = `é…é€è²» â‰ˆ ${delivery.toFixed(4)} å…ƒ`;
}

// ç›£è½è¼¸å…¥è®ŠåŒ–å³æ™‚æ›´æ–°
document.getElementById('baseFare').addEventListener('input', calcDelivery);
document.getElementById('rateFare').addEventListener('input', calcDelivery);

// é‡ç½®æŒ‰éˆ•ï¼šæ¢å¾©ç‚º 42 / 1.4 ä¸¦æ›´æ–°é¡¯ç¤º
document.getElementById('resetBtn').addEventListener('click', function() {
  document.getElementById('baseFare').value = 42;
  document.getElementById('rateFare').value = 1.4;
  calcDelivery();
  calc();         // æ›´æ–°å…¬å¼å€
});
document.getElementById('baseFare').addEventListener('input', function() {
  calcDelivery(); // æ›´æ–°å°å·¥å…·é¡¯ç¤º
  calc();         // æ›´æ–°å…¬å¼å€
});
document.getElementById('rateFare').addEventListener('input', function() {
  calcDelivery(); // æ›´æ–°å°å·¥å…·é¡¯ç¤º
  calc();         // æ›´æ–°å…¬å¼å€
});


// é é¢è¼‰å…¥å¾Œè‡ªå‹•è¨ˆç®—ä¸€æ¬¡
window.addEventListener('load', calcDelivery);
</script>


<div style="text-align:center; margin-top:30px; font-size:14px; color:#fc0303; line-height:1.8; border-top:1px solid #ccc; padding-top:10px;">
  âš ï¸ æ³¨æ„äº‹é …ï¸ âš ï¸ <br>
  â€»ç›®å‰æœªçŸ¥å®˜æ–¹å¯¦éš›ç®—æ³•å®˜æ–¹åªæä¾›è³‡è¨Š:â€»<br>
  â€»é…é€è²»(åŒ…å«é‡Œç¨‹)xå€ç‡+å»£å‘Š+å®‰å…¨çå‹µâ€»<br>
  â€»åªæœ‰é…é€è²»æœªçŸ¥â€»<br>
  â€»é‡Œç¨‹.å€ç‡.å»£å‘Š.å®‰å…¨çå‹µç¢ºå®šæ•¸å€¼â€»<br>
  â€»æš«æ™‚ä»¥ç¾åœ¨åŸºæœ¬å–®åƒ¹42å»æ¨ç®—é…é€è²»â€»<br>
  â€» ä¸€èˆ¬ç†Šè²“èˆŠåˆ¶å°±æœƒå·é å–®å…¬é‡Œæ•¸0.3~0.8å…¬é‡Œä¸ç­‰ï¼Œè«‹è‡ªè¡Œå†æ‰£é™¤â€»<br>
  â€» ä»¥ä¸Šåƒ…ä¾›åƒè€ƒâ€»<br>
  v1.1
  2025å¹´10æœˆ17æ—¥ 04:13
</div>
</body>
</html>

